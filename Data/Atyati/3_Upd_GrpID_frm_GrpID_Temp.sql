MERGE INTO FT_ATYATI_GROUPID L
USING (SELECT DISTINCT(D.GROUP_ID), D.STATE, D.GROUP_NAME, D.PRODUCT_CODE , D.ACTIVE_STATUS
FROM FT_ATYATI_GROUPID_TEMP D) TMP
ON (L.GROUP_ID = TMP.GROUP_ID)
WHEN MATCHED THEN
UPDATE SET L.ACTIVE_STATUS ='Yes'
WHEN NOT MATCHED THEN INSERT (L.GROUP_ID, L.STATE, L.GROUP_NAME, L.PRODUCT_CODE, L.ACTIVE_STATUS)
VALUES (TMP.GROUP_ID, TMP.STATE, TMP.GROUP_NAME, TMP.PRODUCT_CODE, TMP.ACTIVE_STATUS)
where TMP.GROUP_ID IS NOT NULL;
commit;